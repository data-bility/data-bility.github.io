---
title: 딥러닝을 위한 시계열 데이터 증강기법 서베이 논문 리뷰
date: 2024-05-16 00:00:00 +09:00
categories: [backgrounds]
math: true
---

# Time Series Data Augmentation for Deep Learning: A Survey 리뷰
> Qingsong Wen et al., IJCAI 2021, https://arxiv.org/abs/2002.12478

본 게시글에서는 상기 논문을 제 나름대로 요약 및 리뷰합니다. 해당 논문은 딥러닝을 위한 시계열 데이터 증강 관련 연구 동향, 기법들을 조사한 논문입니다. <br>
우선, 논문에 대한 총평과 활용방안에 대해 이야기해보겠습니다.

## 1. 리뷰 요약

> **핵심 내용**
> - 단순한 Time-Domain 증강만으로는 한계가 있다.
> - Frequency 및 Decomposition 기반 접근이 모델의 일반화 성능을 실질적으로 개선할 수 있다.
> - 향후에는 “자동화된 증강 조합 탐색”이 시계열 모델링의 표준이 될 가능성이 높다.

---

## 2. 수요예측 분야에서의 활용?

전자상거래 수요예측(e-commerce demand forecasting)에서는 아래의 문제가 일반적으로 존재합니다.
- **신규 점포/신상품의 데이터 부족**,
- **품절·이상값으로 인한 학습 불균형**,
- **짧은 시계열(window-based forecasting)**

이 논문에서 제시된 기법 중 다음 기법들을 유용할 수 있으리라 기대합니다.

| 문제 유형 | 추천 증강 기법 | 적용 아이디어 |
|------------|----------------|----------------|
| 신규 상품 초기 데이터 부족 | **TimeGAN / MODALS** | 과거 유사 SKU latent embedding에서 synthetic series 생성 |
| 품절·이상값으로 인한 label noise | **Label Expansion + Decomposition** | robustSTL로 이상구간 분리 후 residual 증강 |
| 계절/트렌드 불연속 시계열 | **Wavelet-based (MODWT)** | 다중 주기 성분을 보존하며 non-stationary 특성 유지 |
| 데이터 불균형 | **Cost-sensitive + Augmentation** | 클래스별 weighting + minority oversampling 병행 |
| 자동화된 모델 튜닝 | **AutoAugment / PBA 기반 Policy Search** | SKU별 augmentation 조합 자동 탐색 및 AutoML 연계 |

- 물론, 점포/SKU 별로 개별 모델링을 하는 방식을 채택하고 있는 현재의 프로덕트 정책에서는 데이터 증강에 따른 train data의 변화 및 성능 변화를 체계적으로 트랙킹하기 어렵기 때문에, 상품 수준이 아닌 점포 수준의 모델링을 진행해야할 때엔 유용할 수 있으리라 생각됩니다. 

--- 
## 3. 서론: 시계열에서의 데이터 증강 필요성
딥러닝 기반 시계열 분석(예: 분류, 예측, 이상탐지)은 대규모 학습 데이터에 의존하지만, 실제 환경에서는 레이블이 부족한 경우가 많습니다.  
이 논문은 **시계열 데이터 전용 데이터 증강(Data Augmentation, DA)** 기법을 **체계적으로 정리한 종합 리뷰 논문**입니다.

> 핵심 문제의식:
> - 이미지·음성 분야에서 검증된 증강 기법이 시계열에는 직접 적용되기 어려움.
> - 시계열의 **시간적 종속성(temporal dependency)** 과 **도메인 의존성(task-dependency)** 을 고려한 전용 증강 전략이 필요함.

---

## 4. 기본적 데이터 증강 방법 (Basic Methods)

### 4.1 시간 영역 (Time Domain)


시간 영역에서 직접 값을 변형하는 단순 기법:
- **Cropping / Slicing**: 일정 구간을 잘라내는 서브샘플링
- **Warping**: 구간 단위로 stretch/compress
- **Flipping**: 부호 반전 ($ x'_t = -x_t $)
- **Noise Injection**: Gaussian, spike, step, slope 형태의 노이즈 주입
- **Label Expansion**: anomaly 인근 포인트를 함께 이상값으로 라벨 확장


> 시계열 이상탐지에서는 'blurred boundary' 문제를 보완하기 위해 Label Expansion이 특히 유효함.



---

### 4.2 주파수 영역 (Frequency Domain)
Fourier 변환을 기반으로, 진폭·위상 성분을 조작하여 새로운 데이터를 생성:
- **Amplitude Perturbation**
- **Phase Perturbation**

예: APP(Amp-Phase Perturbation)은 CNN 기반 이상탐지에서 F1 점수를 크게 향상시킴.  
또한 **AAFT / IAAFT**(Iterated Amplitude Adjusted Fourier Transform) 기반 surrogate data는
원래 데이터의 분포와 스펙트럼 특성을 유지한 채 변형 가능.

---

### 4.3 시간-주파수 영역 (Time-Frequency Domain)
STFT, Mel-Spectrogram 등 time-freq 표현에서 변형을 수행:
- **STFT 기반 Local Averaging / Shuffling**
- **SpecAugment (Masking in Time/Freq)**: 음성인식에서 검증된 기법

---

## 5. 고급 데이터 증강 방법 (Advanced Methods)

### 5.1 분해 기반 (Decomposition-based)
STL 또는 RobustSTL 등으로 **trend(τ), seasonality(s), residual(r)** 분해 후  
각 성분을 독립적으로 증강:


$$x_t = \tau_t + s_t + r_t$$


-> Residual에 bootstrap, noise injection 등 수행 후 재조합.  
Forecasting 성능 개선에 일관된 효과를 보임.

---

### 5.2 통계적 생성 모델 (Statistical Generative Models)
시계열의 확률적 구조를 명시적으로 모형화:
- **Mixture of Gaussian Trees**, **Mixture AutoRegressive (MAR)**
- **Local & Global Trend (LGT)** 샘플링 기반 augmentation

-> 희소 클래스 오버샘플링이나 불균형 데이터 문제에 유용.

---

### 5.3 학습 기반 (Learning-based)

#### (1) Embedding Space
Autoencoder의 잠재공간에서 interpolation/extrapolation을 통해 새로운 샘플 생성.
- 예: **MODALS (ICLR 2021)** — latent space 상의 조합을 진화 탐색으로 최적화.

#### (2) Deep Generative Models (DGMs)
GAN, VAE, Flow 등 생성모델을 시계열에 적용:
- **RGAN / RCGAN (Esteban et al., 2017)**
- **TimeGAN (Yoon et al., 2019)** — adversarial + supervised + embedding 학습 병행
- **Privacy 보장형 GAN**도 의료 시계열에서 적용 가능

#### (3) Automated Data Augmentation
강화학습 또는 진화탐색으로 augmentation policy를 자동 탐색:
- **AutoAugment (Cubuk et al., 2019)**
- **RandAugment (2020)**
- **MODALS / TANDA / PBA** — time series용 자동 정책 탐색 연구도 등장

---

## 6. 실험 결과 요약



| Task | 주요 데이터 | 모델 | 성능 향상 포인트 |
|------|--------------|------|------------------|
| Classification | Alibaba Cloud (5min interval) | FCN | Outlier injection 상황에서 +0.1~1.9% acc 개선 |
| Anomaly Detection | Yahoo! Dataset | U-Net 기반 | F1 0.403 → 0.693 (+72%) |
| Forecasting | UCI, M4 Datasets | DeepAR, Transformer | 평균 MASE 개선 (최대 +76%) |



-> 단, 일부 데이터셋에서는 오히려 악화되는 케이스도 존재 → **policy selection의 중요성** 강조.

---

## 7. 향후 연구 방향 (Future Opportunities)

1. **Time-Frequency 기반 증강**
  - Wavelet (CWT/DWT/MODWT) 기반 변환에서의 진폭·위상 변조
  - 비정상(non-stationary) 데이터에 강건

2. **불균형 클래스 증강 (Imbalanced Class)**
  - SMOTE-like oversampling + cost-sensitive loss 통합 설계

3. **증강 조합 최적화 (Selection & Combination)**
  - Reinforcement / Meta-Learning 기반 augmentation policy search

4. **Gaussian Process 기반 증강**
  - 커널 기반 확률적 샘플링으로 시계열 다양성 확보
  - Deep Gaussian Process를 이용한 비선형 시계열 생성 가능

5. **Deep Generative Model 확장**
  - GAN 이외에 **VAE, Normalizing Flow, DARN(WaveNet형)** 으로 확장 가능
